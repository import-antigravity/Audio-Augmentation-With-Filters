import seaborn as sn
import pandas as pd
import matplotlib.pyplot as plt

model_au = cnn_rand()
model_au.load_weights('16-0.03.hdf5',by_name=True)

npz = np.load('augmented_val.npz')

test_features_name, test_labels_name= npz.files
test_features_filter = npz[test_features_name]
test_labels_fliber = npz[test_labels_name]

predictedvalue_au  = model_au.predict(test_features_filter)
cm_au = tf.math.confusion_matrix(labels=tf.argmax(test_labels_fliber , 1), predictions=tf.argmax(predictedvalue_au, 1))
plt.figure(figsize = (8,8))
sn.set(font_scale=0.8)#for label size
x_axis_labels =['air conditioner','car horn','dog bark','children playing','drilling','engine idling','gun shot','jackhammer','siren','street music']

sn.heatmap(cm_au, annot=True,annot_kws={"size": 10}, cmap="Blues",fmt='g',xticklabels=x_axis_labels, yticklabels=x_axis_labels)# font size
plt.show()
